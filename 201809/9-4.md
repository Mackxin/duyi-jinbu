# 9.4

直接主题

```javascript
for (var i = 0; i < 5; i++){
    setTimeout(function(){
        console.log(i);
    },1000);
}
console.log(i);
1. 控制台会输出什么？
2.如果我们约定，用箭头表示其前后的两次输出之间有1秒的时间间隔，而逗号表示其前后的两次输出之间的时间间隔可以忽略，代码实际运行的结果改如何描述？
```

解析：

代码执行过程如下：

（1）先用循环几乎同时设置了5个定时器，并且i的值由0变成了5；

（2）循环体外console.log(i)，打印1个5；

（3）大约1秒之后，5个定时器都触发，打印5个5

setTImeout是JS最基本的异步函数，本题主要是对JS同步和异步知识点的考察，那么这里说的同步和异步的到底是什么呢？

“同步”，一下就让人想到“一起”这个词；“异步”呢，从字面来讲，像是“一边...一边...”，比如“小明一边吃雪糕一边写作业”，，雪糕吃完了，作业也写完了，看起来完全没毛病，但是这样理解JS的同步和异步就错了！javascript语言是一门单线程的语言，所有任务可以分为两种，一种是同步任务，另一种是异步任务。同步任务指的是，在“主线程”上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；异步任务指的是，不进入主线程、而进入“任务队列”的任务，只有等主线程任务执行完毕，“任务队列”开始通知主线程，请求执行任务，该任务才会进入主线程执行。

具体来说，异步执行的运行机制如下。（同步执行也是如此，因为它可以被视为没有异步任务的异步执行。）

（1）所有同步任务都在主线程上执行，形成一个“执行栈”。

（2）主线程之外，还存在一个“任务队列”。只要异步任务有了运行结果，就在“任务队列”之中放置一个时间。

（3）一旦“执行栈”中的所有同步任务执行完毕，系统就会读取“任务队列”，看看里面有哪些事件。那些对应的异步任务，结束等待状态，进入执行栈，开始执行。

（4）主线程不断重复上面的第三步。

---

结果是

1.  555555。
2. 5->5,5,5,5,5   即直接输出1个5,1秒后，输出5个人5